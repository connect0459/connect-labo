# 【日報】2025-11-28

## PEP 751雑まとめ

[PEP 751](https://peps.python.org/pep-0751/) にて、Python標準のlockファイル規格が定められたことを知らなかった。昨日の夜に色々見ていたのでざっくりまとめたい。

### Python標準lockファイルとしてのPEP 751

PEP 751は、Pythonにおける「lockファイルの標準規格がない」という長年の課題に対する公式な回答として出された。Poetryは `poetry.lock` 、Pipenvは `Pipfile.lock` など、ツールごとにバラけていたlockファイルのフォーマットに標準規格を与えることで、ツール間の相互運用性を担保しようとしている。

### 各ツールの対応状況

2025年11月時点で、pipはバージョン25.1以降で `pip lock` コマンドによるPEP 751形式の生成とインストールをサポート。PDMなどはネイティブに近い形式でサポートしている。

一方、最も勢いのあるuvはPEP 751を「エクスポート/インポート形式」としてのみサポートし、メインのロックファイルには採用しない方針。理由は **ワークスペース（モノレポ）のサポート** がPEP 751の仕様から除外されているため、複数のプロジェクトが相互依存するモノレポ構成では、PEP 751では要件を満たせない。

### どれ使えばいいの

とりあえずuv使っとけ、という感じではありそう。uvも `uv.lock` から `pylock.toml` への変換はサポートしており、 `uv export --format pylock.toml -o pylock.toml` で生成可能。PEP 751が出てもuvの実行速度やツール系のサポートの魅力は変わらないので、uvをメインに据え、必要であれば `pylock.toml` を作ってCI環境で実行する、とか？でもGitHub Actionsにも [astral-sh/setup-uv](https://github.com/astral-sh/setup-uv) があるしな…
